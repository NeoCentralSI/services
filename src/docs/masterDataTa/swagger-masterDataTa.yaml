openapi: 3.0.0
info:
  title: Master Data Tugas Akhir API
  description: API for managing thesis master data
  version: 1.0.0

tags:
  - name: Master Data Tugas Akhir
    description: Endpoints for Kadep, Sekdep, and Admin to manage thesis master data

paths:
  /api/v1/master-data-ta:
    get:
      summary: Get all thesis master data
      description: Retrieve a list of all theses including student, topic, and supervisor details.
      tags:
        - Master Data Tugas Akhir
      security:
        - bearerAuth: []
      responses:
        '200':
          description: A list of thesis master data.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Berhasil mengambil master data tugas akhir
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ThesisMasterData'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      summary: Create a new thesis
      description: Create a new thesis record along with its supervisors.
      tags:
        - Master Data Tugas Akhir
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - studentId
              properties:
                studentId:
                  type: string
                  format: uuid
                title:
                  type: string
                  nullable: true
                thesisTopicId:
                  type: string
                  format: uuid
                  nullable: true
                academicYearId:
                  type: string
                  format: uuid
                  nullable: true
                startDate:
                  type: string
                  format: date-time
                  nullable: true
                supervisors:
                  type: array
                  items:
                    type: object
                    required:
                      - lecturerId
                      - roleId
                    properties:
                      lecturerId:
                        type: string
                        format: uuid
                      roleId:
                        type: string
                        format: uuid
      responses:
        '201':
          description: Thesis created successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Berhasil membuat data tugas akhir
                  data:
                    type: object
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/v1/master-data-ta/{id}:
    patch:
      summary: Update a thesis
      description: Update an existing thesis record and its supervisors.
      tags:
        - Master Data Tugas Akhir
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: Thesis ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  nullable: true
                thesisTopicId:
                  type: string
                  format: uuid
                  nullable: true
                academicYearId:
                  type: string
                  format: uuid
                  nullable: true
                startDate:
                  type: string
                  format: date-time
                  nullable: true
                rating:
                  type: string
                  enum: [ONGOING, PASSED, FAILED, CANCELLED, DELAYED]
                supervisors:
                  type: array
                  items:
                    type: object
                    required:
                      - lecturerId
                      - roleId
                    properties:
                      lecturerId:
                        type: string
                        format: uuid
                      roleId:
                        type: string
                        format: uuid
      responses:
        '200':
          description: Thesis updated successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Berhasil mengubah data tugas akhir
                  data:
                    type: object
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'

components:
  schemas:
    ThesisMasterData:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
          nullable: true
        rating:
          type: string
        startDate:
          type: string
          format: date-time
          nullable: true
        status:
          type: string
        student:
          type: object
          properties:
            id:
              type: string
              format: uuid
            nim:
              type: string
            name:
              type: string
        topic:
          type: object
          nullable: true
          properties:
            id:
              type: string
              format: uuid
            name:
              type: string
        academicYear:
          type: object
          nullable: true
          properties:
            id:
              type: string
              format: uuid
            semester:
              type: string
            year:
              type: integer
        supervisors:
          type: array
          items:
            type: object
            properties:
              lecturerId:
                type: string
                format: uuid
              name:
                type: string
              roleId:
                type: string
                format: uuid
              roleName:
                type: string
